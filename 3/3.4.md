## メモリ

### 3.4.1 メモリの種類と特徴
 - 揮発性
   - SRAM (Static RAM)：高速だが容量当たり単価が高い。キャッシュメモリとかに利用される
   - DRAM (Dynamic Ram) ：種記憶に利用。SRAMに比べると遅い（リフレッシュ処理が必要なので）。

 - 不揮発性
   - フラッシュメモリ：NAND型（書き込みが高速、大容量）とNOR型（読み出しが高速、高信頼性）がある。
   - FeRAM

### 3.4.2 記憶階層
記憶装置は基本的に高速なものほど大容量化に向かず高い。  
レジスタ・キャッシュメモリ \<---------> メモリ・HDD/SSD  
のように、用途によって使い分けることで、大容量の記憶装置があるかのように振る舞う

### 3.4.3 実行アクセス時間
実行アクセス時間 = キャッシュメモリのアクセス時間 x キャッシュにほしいデータがある確率 + 種記憶のアクセス時間 x キャッシュメモリにほしいデータがない確率

小容量のキャッシュメモリを導入して、全体のアクセス速度を上げられるのならコスパがよいので、上の式で諸々比較するのが重要。

### 3.4.4 メモリへの書き込み方式
 - ライトスルー方式：書き込み命令発生時に、キャッシュメモリと主記憶の両方に書き込み。キャッシュとメモリのデータの一貫性は高いが、メモリに書き込みに行くので遅い。
 - ライトバック方式：まずキャッシュに書き込み、キャッシュからデータが追い出されるときにメモリに書き込む。ライトスルーよりは高速だが、キャッシュ-主記憶間の一貫性が担保できない。このせいで、構造も複雑になりがち。Least Recently Used （最も最後に使ったものから追い出し）が多いがFIFOとかもあるよ。


プロセッサがメモリを共有している場合、それぞれの動作で他のプロセッサとメモリ上のデータが一致しなくなるので、内容を正しく保つ必要がある。  
各CPUが共有するデータを監視して、自分が関係あるデータが変更されたら、自分のキャッシュのデータも変更するか、そのデータを無効化する（スヌープ方式）。


### 3.4.5 キャッシュメモリと主記憶のアドレスの対応付け方
 - ダイレクトマッピング：主記憶のブロック番号 mod キャッシュメモリのブロック数 = キャッシュメモリのブロック番号。
 - フルアソシアティブ：適宜対応付ける。どのような対応なのか管理が必要なので、上と比べると追加コストがかかる
 - セットアソシアティブ：主記憶のここからここまでは、キャッシュのブロック１が好きに割り当てていいよ、みたいな。上二つの中間。

### メモリインタリーブ
メモリをいくつかの区画に分けて、それらに平行にアクセスすることで、全体の速度を高速化する仕組み。一つの区画に欲しいデータが偏っている、とかの場合は高速アクセスできない。


